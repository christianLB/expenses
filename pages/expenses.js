import Head from "next/head";
import Footer from "../components/Footer.tsx";
import NewExpense from "../components/NewExpense.tsx";
import ExpensesDashboard from "../components/ExpensesDashboard.tsx";
import Table from "../components/DataTable/DataTable.tsx";
import {
  NumberInput,
  NumberInputField,
  NumberInputStepper,
  NumberIncrementStepper,
  NumberDecrementStepper,
  Accordion,
  AccordionItem,
  AccordionButton,
  AccordionPanel,
  Box,
  Text,
  VStack,
  Grid,
  GridItem,
} from "@chakra-ui/react";
import { useExpensesContext } from "../hooks/expensesContext.tsx";

export default function Expenses() {
  const { currentYear, setCurrentYear } = useExpensesContext();
  return (
    <div className="min-h-screen flex flex-col">
      <Head>
        <title>Expenses</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className="flex-1 p-4 md:p-8">
        <div className="max-w-5xl mx-auto">
          <VStack spacing={6} w="100%">
            <Box>
              <Grid
                templateColumns="repeat(auto-fit, minmax(240px, 1fr))"
                gap={4}
              >
                <GridItem>
                  <Box
                    display="flex"
                    alignItems="center"
                    flexWrap="wrap"
                    p={4}
                    borderWidth={1}
                    borderRadius="lg"
                  >
                    <Text marginRight="0.5rem">Year:</Text>
                    <NumberInput
                      defaultValue={currentYear}
                      onChange={(valueString) =>
                        setCurrentYear(parseInt(valueString))
                      }
                      className="mb-2 md:mb-0"
                    >
                      <NumberInputField />
                      <NumberInputStepper>
                        <NumberIncrementStepper />
                        <NumberDecrementStepper />
                      </NumberInputStepper>
                    </NumberInput>
                  </Box>
                </GridItem>
                <GridItem>
                  <Box
                    p={4}
                    borderWidth={1}
                    borderRadius="lg"
                    overflow="hidden"
                  >
                    <Accordion allowToggle>
                      <AccordionItem>
                        <h2>
                          <AccordionButton>Add new expense</AccordionButton>
                        </h2>
                        <AccordionPanel>
                          <NewExpense />
                        </AccordionPanel>
                      </AccordionItem>
                    </Accordion>
                  </Box>
                </GridItem>
              </Grid>
            </Box>

            <Box borderWidth={1} borderRadius="lg" overflow="hidden">
              <Table />
            </Box>

            <Box borderWidth={1} borderRadius="lg" overflow="hidden">
              <ExpensesDashboard />
            </Box>
          </VStack>
        </div>
      </main>
      <Footer />
    </div>
  );
}
